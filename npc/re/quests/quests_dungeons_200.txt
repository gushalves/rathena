//===== rAthena Script =======================================
//= New dungeons
//===== Description: =========================================
//= [Walkthrough Conversion]
//===== Changelog: ===========================================
//= 1.0 Added amicitia1 and amicitia2 quests. [Capuche]
//============================================================

// amicitia1
ein_fild08,158,96,3	script	Lana#ami	4_M_ILYA,{
	if (BaseLevel < 215) {
		mes "[Lana]";
		mes "Beyond this is dangerous, so access is restricted except for adventurers above a certain level.";
		next;
		mes " - This area can be accessed from level 215 or higher -";
		close;
	}
	mes "[Lana]";
	mes "Would you like to go to the first floor of the Amicitia General Lab?";
	next;
	if (select( "Go", "Stay" ) == 2) {
		mes "[Lana]";
		mes "Okay. Have a nice adventure then.";
		close;
	}
	mes "[Lana]";
	mes "Okay. I will transfer you to the Amicitia General Lab.";
	close2;
	warp "amicitia1",242,244;
	end;
}

pub_cat,86,33,5	script	Ansuriya#ami	4_F_REBELLION2,{
	if (BaseLevel < 215) {
		mes "[Ansuriya]";
		mes "Oh, you are the hero of the last operation.";
		mes "It's an honor to meet you in a place like this. May I buy you a drink?";
		next;
		mes " - This is a quest that can be performed at level 215 or higher - ";
		close;
	}
	if (isbegin_quest(16529) == 0) {
		mes "[Ansuriya]";
		mes "Oh, you are the hero of the last operation.";
		mes "It's an honor to meet you in a place like this. May I buy you a drink?";
		next;
		mes "[Gerbena]";
		mes "Wow, " + strcharinfo(0) + "! Can you sign?";
		mes "It's an honor! Hehe~";
		next;
		mes "[Ansuriya]";
		mes "Here, a glass of tropical sograt, please!";
		mes "Oh, are you okay with Tropical Sogra?";
		next;
		mes "[Gerbena]";
		mes "I like chocolate milk.";
		next;
		mes "[Ansuriya]";
		mes "You buy it with your money.";
		mes "By the way, Gerbena, what's going on with Amicitia's edge?";
		next;
		emotion ET_PROFUSELY_SWAT, getnpcid(0,"Gerbena#ami");
		mes "[Gerbena]";
		mes "Well, that's it once the formation is finished.";
		mes "However, it is true that the number of rebellions to be deployed is a bit short since the total number of members is small.";
		next;
		mes "[Ansuriya]";
		mes "Hmm, how are you? Gerbena. Would you like to go?";
		next;
		emotion ET_SWEAT, getnpcid(0,"Gerbena#ami");
		mes "[Gerbena]";
		mes "Ah, take a look. My head is falling out just with all the staff.";
		next;
		mes "[Ansuriya]";
		mes "What should I do? We need two teams per floor...";
		next;
		emotion ET_AHA, getnpcid(0,"Gerbena#ami");
		mes "[Gerbena]";
		mes "I, maybe a hero.";
		mes "Can you help us?";
		next;
		emotion ET_QUESTION;
		mes "[Ansuriya]";
		mes "Gerbena, what are you talking about all of a sudden!";
		next;
		mes "[Gerbena]";
		mes "No, the hero was assigned a mission in association with Rebellion in the last operation.";
		mes "So I was wondering if you could apply for me again this time...";
		next;
		emotion ET_SURPRISE;
		mes "[Ansuriya]";
		mes "Uh! yes.";
		mes "Adventurer. What do you think?";
		next;
		select( "Listen to what's going on..." );
		mes "[Ansuriya]";
		mes "Oh, yes. That's the order.";
		mes "Nothing else, we have discovered a new laboratory around Einbrok.";
		next;
		mes "[Ansuriya]";
		mes "The name is <FONT COLOR = 0000CD>Amicitia General Research Institute</FONT>. According to the data provided by Rekenberg, it is said to be a sister laboratory of the Werner Institute.";
		next;
		mes "[Ansuriya]";
		mes "It seems that it did not conduct very illegal experiments and focused on the study of culturing chimeras as homunculus, but it is said that it was abandoned after an explosion at an underground magical power plant.";
		next;
		mes "[Ansuriya]";
		mes "I came under investigation because one of the administrators of that abandoned lab was Werner.";
		next;
		mes "[Ansuriya]";
		mes "As a result of the investigation, the chimeras in cultivation ran out due to an explosion, and the monsterized ones were left unattended.";
		next;
		mes "[Ansuriya]";
		mes "I didn't know if it was just neglected or if it was intentionally neglected.";
		next;
		mes "[Ansuriya]";
		mes "Because it's not far from the city, I took care of cleaning up at Rebellion for the sake of safety... As you've heard, we're having trouble due to a shortage of people.";
		next;
		mes "[Gerbena]";
		mes "If the hero helps us, we will be able to organize the work more easily!";
		next;
		mes "[Ansuriya]";
		mes "Yes. Can you help me subdue?";
		next;
		if (select( "Helps", "Doesn't help" ) == 2) {
			mes "[Ansuriya]";
			mes "Ah... Excuse me.";
			mes "It's our job, and we're just looking for your help.";
			next;
			mes "[Ansuriya]";
			mes "Your hero must have his work!";
			mes "We will try to solve this by ourselves.";
			close;
		}
		mes "[Gerbena]";
		mes "It is an honor to work with you!";
		next;
		mes "[Ansuriya]";
		mes "Thank you for your cooperation!";
		mes "Then regrouping...";
		next;
		mes "[Ansuriya]";
		mes "Are you comfortable taking the mission alone or with the Rebellion's mission team?";
		next;
		select( "I'm comfortable alone" );
		mes "[Ansuriya]";
		mes "Then, unite the Rebellion mission team and perform the hero's sole mission! mumble.";
		mes "Oh, why am I thinking alone. Gerbena, you do it too!";
		next;
		mes "[Gerbena]";
		mes "Ah, I see!";
		setquest 16529;
		completequest 16529;
		next;
	}
	mes "[Ansuriya]";
	mes "Hero, these are the things we would like to ask of you from Amicitia.";
	mes "Which of these would you like to help with?";
	next;
	switch( select("Earth and Fire", "Water and Wind", "Werner's Trace", "Doesn't help" ) ) {
	case 1:
		switch( checkquest(16530,PLAYTIME) ) {
		case -1:
			break;
		case 0:
		case 1:
			mes "[Ansuriya]";
			mes "Hmm? Have you changed your mind?";
			next;
			mes "[Ansuriya]";
			mes "Well, then! we have to re-organize! Ugh.";
			mes "Hero, why don't you reconsider calmly?";
			close;
		case 2:
			erasequest 16530;
			break;
		}
		switch( checkquest(16531,HUNTING) ) {
		case -1:
			mes "[Ansuriya]";
			mes "I would like to ask you to hunt <FONT COLOR = 0000CD>mutant chimera Amitera and mutant chimera Fillia</FONT> among the chimeras in culture.";
			next;
			mes "[Ansuriya]";
			mes "The properties of earth and fire are much stronger than those of existing entities, and you will be able to recognize them immediately.";
			mes "Actually, it's more like a monster than a homunculus...";
			next;
			mes "[Ansuriya]";
			mes "Despite the destruction of the culture facility, the number of individuals continues to increase, so I would like to ask for the quantity! about 15 specimens each.";
			next;
			if (select( "Hunt", "Do not hunt" ) == 2) {
				mes "[Ansuriya]";
				mes "Hmm? Have you changed your mind?";
				next;
				mes "[Ansuriya]";
				mes "Well, then! we have to re-organize! Ugh.";
				mes "Hero, why don't you reconsider calmly?";
				close;
			}
			mes "[Ansuriya]";
			mes "Thank you very much for your support. The two types of chimeras will probably be roaming the ground floor of the closed lab Amicitia.";
			next;
			mes "[Ansuriya]";
			mes "Please don't let the chimeras leave the lab.";
			setquest 16531;
			close;
		case 0:
		case 1:
			mes "[Ansuriya]";
			mes "<FONT COLOR = 0000CD>The Mutant Chimera Amitera and the Mutant Chimera Fillia</FONT> will be roaming the first floor of the closed lab Amicitia.";
			next;
			mes "[Ansuriya]";
			mes "15 each, please take good care of the hunt.";
			close;
		case 2:
			mes "[Ansuriya]";
			mes "Have you been there? You have completed all the tasks I mentioned.";
			next;
			mes "[Ansuriya]";
			mes "Rebellion units are also on duty.";
			mes "Thanks to the hero who organized it one step ahead, it seems to have made it easier to enter.";
			next;
			mes "[Ansuriya]";
			mes "As expected, a hero. It is rare to find someone outside of Rebellion who works with such sincerity and cleanliness.";
			mes "I would be grateful if you could join the mission tomorrow as well.";
			erasequest 16531;
			setquest 16530;
			getexp 17726670,12408690;	// TODO: the amount has been changed which the monster update
			close;
		}
		end;
	case 2:
		switch( checkquest(16532,PLAYTIME) ) {
		case -1:
			break;
		case 0:
		case 1:
			mes "[Ansuriya]";
			mes "Now the rebellion troops are in and are working on follow-up.";
			mes "Hero, it's okay to come after a little rest.";
			next;
			mes "[Ansuriya]";
			mes "Thank you for being so active with us.";
			mes "Will you come back after dawn?";
			close;
		case 2:
			erasequest 16532;
			break;
		}
		switch( checkquest(16533,HUNTING) ) {
		case -1:
			mes "[Ansuriya]";
			mes "I would like to ask you to hunt <FONT COLOR = 0000CD>mutant chimera Litus and mutant chimera Vanilaqus</FONT> among the chimeras that were being cultured.";
			next;
			mes "[Ansuriya]";
			mes "It's easy to tell the difference between the wind and water properties because they have changed into an appearance that clearly reveals them.";
			next;
			mes "[Ansuriya]";
			mes "The number of individuals continues to increase without the help of a culture facility, so the quantity! 15 each, please.";
			next;
			if (select( "Hunt", "Do not hunt" ) == 2) {
				mes "[Ansuriya]";
				mes "Hmm? Have you changed your mind?";
				next;
				emotion ET_KEK;
				mes "[Ansuriya]";
				mes "Well, then! we have to re-organize! Ugh.";
				mes "Hero, why don't you reconsider calmly?";
				close;
			}
			mes "[Ansuriya]";
			mes "Thank you very much for your support. The two types of chimeras are staying on the first floor of the closed lab Amicitia.";
			next;
			mes "[Ansuriya]";
			mes "Please don't let the chimeras leave the lab.";
			setquest 16533;
			close;
		case 0:
		case 1:
			mes "[Ansuriya]";
			mes "<FONT COLOR = 0000CD>Mutant Chimera Litus and Mutant Chimera Vanilaqus</FONT> are staying on the first floor of the closed lab Amicitia.";
			next;
			mes "[Ansuriya]";
			mes "15 each, please take good care of the hunt.";
			close;
		case 2:
			mes "[Ansuriya]";
			mes "Mission completed, confirmed.";
			mes "Now deploy the rebellion troops.";
			next;
			mes "[Ansuriya]";
			mes "Thanks to the hero who organized it one step ahead, we will be able to enter easily..";
			mes "Thank you very much.";
			next;
			mes "[Ansuriya]";
			mes "Working with someone outside of Rebellion, this is the first time I've felt such a good fit.";
			mes "Hero, would you like to join the mission tomorrow as well?";
			setquest 16532;
			erasequest 16533;
			getexp 17724090,12406890;	// TODO: the amount has been changed which the monster update
			close;
		}
		end;
	case 3:
		switch( checkquest(16534,PLAYTIME) ) {
		case -1:
			break;
		case 0:
		case 1:
			mes "[Ansuriya]";
			mes "Now the rebellion troops are in and are working on follow-up.";
			mes "Hero, it's okay to come after a little rest.";
			next;
			mes "[Ansuriya]";
			mes "Thank you for being so active with us.";
			mes "Will you come back after dawn?";
			close;
		case 2:
			erasequest 16534;
			break;
		}
		switch( isbegin_quest(16535) ) {
		case 0:
			mes "[Ansuriya]";
			mes "This is a high-security job, so I only want to ask the hero a favor.";
			next;
			mes "[Ansuriya]";
			mes "I didn't want to go through the mouths of as many people as possible, so the Rebellion units were excluded from this job.";
			next;
			mes "[Ansuriya]";
			mes "Nothing else, but to find <FONT COLOR = 0000CD>Traces of Werner</FONT> on the 1st floor of the abandoned lab Amicitia.";
			next;
			mes "[Ansuriya]";
			mes "What part of Amicitia was managed by Werner, what kind of experiments he conducted, etc...";
			mes "If anything has had an impact on the Institute, please come to me.";
			next;
			mes "[Ansuriya]";
			mes "Documents, files, data! anything is fine.";
			mes "Would you like to come with me?";
			next;
			if (select( "I will go", "I will not go" ) == 2) {
				mes "[Ansuriya]";
				mes "That's right. It's also annoying...";
				next;
				mes "[Ansuriya]";
				mes "I would appreciate it if you could keep this request a secret.";
				close;
			}
			mes "[Ansuriya]";
			mes "Okay. It won't be easy to find... any traces, so please come to just one.";
			mes "Then, I would like to thank you.";
			setquest 16535;
			close;
		case 1:
			mes "[Ansuriya]";
			mes "It won't be easy to find... any traces, so please come to just one.";
			mes "Then, I would like to thank you.";
			close;
		case 2:
			mes "[Ansuriya]";
			mes "Did you find any traces?";
			mes "You've come to the right place. This note is in Werner's handwriting.";
			next;
			mes "[Ansuriya]";
			mes "Thank you. We will hand this over to the secret wing agents for investigation.";
			mes "Then you should be rewarded for your hard work.";
			next;
			mes "[Ansuriya]";
			mes "Thank you for coming back tomorrow and working with us.";
			mes "Because you can't just leave this to anyone.";
			erasequest 16535;
			erasequest 16545;
			setquest 16534;
			getexp 17000000,12000000;
			close;
		}
		end;
	case 4:
		mes "[Ansuriya]";
		mes "Hmm? Have you changed your mind?";
		next;
		mes "[Ansuriya]";
		mes "Well, then! we have to re-organize! Ugh.";
		mes "Hero, why don't you reconsider calmly?";
		close;
	}
	close;

OnInit:
	questinfo( QTYPE_QUEST2, QMARK_YELLOW, "checkquest(16531,HUNTING) == 2" );
	questinfo( QTYPE_QUEST2, QMARK_YELLOW, "checkquest(16533,HUNTING) == 2" );
	questinfo( QTYPE_QUEST2, QMARK_YELLOW, "isbegin_quest(16535) == 2" );

	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "checkquest(16530,PLAYTIME) == 2" );
	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "checkquest(16532,PLAYTIME) == 2" );
	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "checkquest(16534,PLAYTIME) == 2" );

	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "BaseLevel >= 215 && (checkquest(16531,HUNTING) == -1 && checkquest(16530,PLAYTIME) == -1)" );
	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "BaseLevel >= 215 && (checkquest(16533,HUNTING) == -1 && checkquest(16532,PLAYTIME) == -1)" );
	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "BaseLevel >= 215 && (isbegin_quest(16535) == 0 && checkquest(16534,PLAYTIME) == -1)" );
	end;
}

amicitia1,57,242,3	script	Something#ami1	4_GC109,{
	if (isbegin_quest(16535) == 1) {
		mes "[Something]";
		mes "There is something on the floor. Shall we take a closer look?";
		next;
		mes "[Something]";
		mes "Research memo in neat handwriting. Werner's handwriting is exactly like this.";
		next;
		mes "[Something]";
		mes "Let's take it and check it out.";
		setquest 16545;
		completequest 16535;
		close2;
		initnpctimer;
		disablenpc();
		end;
	}
	mes "[Something]";
	mes "Something is off the floor.";
	mes "!it looks like it's just garbage.";
	close;

OnTimer300000:	// unknown timer
	stopnpctimer;
	enablenpc();
	end;
}
amicitia1,152,159,3	duplicate(Something#ami1)	Something#ami2	4_GC109
amicitia1,262,139,3	duplicate(Something#ami1)	Something#ami3	4_GC109
amicitia1,36,106,3	duplicate(Something#ami1)	Something#ami4	4_GC109
amicitia1,244,49,3	duplicate(Something#ami1)	Something#ami5	4_GC109

// amicitia2
pub_cat,89,32,3	script	Gerbena#ami	4_M_REBELLION2,{
	if (BaseLevel < 230) {
		mes "[Gerbena]";
		mes "Wow, " + strcharinfo(0) + "! Can you sign?";
		mes "It's an honor! Hehe~";
		next;
		mes " - This is a quest that can be performed at level 230 or higher - ";
		close;
	}
	mes "[Gerbena]";
	mes "Hero, there was a homunculus intensive culture room on the second floor of the lab Amicitia.";
	mes "They were creating more powerful mutated chimeras.";
	next;
	mes "[Gerbena]";
	mes "It's pitiful, but if you're released from the lab, you'll do more damage than you can imagine.";
	mes "Can you help me clean up these chimeras?";
	next;
	switch( select("Imitation and real", "Natural change", "Doesn't help" ) ) {
	case 1:
		switch( checkquest(16536,PLAYTIME) ) {
		case -1:
			break;
		case 0:
		case 1:
			mes "[Gerbena]";
			mes "Have you already been there today? If so, how about taking a break?";
			mes "If you overwork your body, you may not do well.";
			next;
			mes "[Gerbena]";
			mes "Come back after dawn and work with us!";
			close;
		case 2:
			erasequest 16536;
			break;
		}
		switch( checkquest(16537,HUNTING) ) {
		case -1:
			mes "[Gerbena]";
			mes "Some of the work I was doing in the incubator was mass production of mutated chimeras.";
			next;
			mes "[Gerbena]";
			mes "Re-mutated the mutated homunculus, and further strengthened its aggression.";
			next;
			mes "[Gerbena]";
			mes "Please hunt 15 <FONT COLOR = 0000CD>Mutation Chimera Napeo and Mutant Chimera Galensis</FONT> each.";
			mes "Both are creatures that imitate human form, but add a powerful transformation of the chimera properties to it.";
			next;
			mes "[Gerbena]";
			mes "It's been quite some time since the lab was closed and left unattended.";
			mes "A quick hunt would make you feel more comfortable.";
			next;
			if (select( "Help hunting", "Do not hunt" ) == 2) {
				mes "[Gerbena]";
				mes "Ah, you changed your words!";
				mes "Gerbena vs. Heartbroken!";
				next;
				mes "[Gerbena]";
				mes "But it was our one-sided request.";
				mes "Even if you refuse, we can't help it...";
				close;
			}
			mes "[Gerbena]";
			mes "It's an honor to help!";
			mes "Can I participate with that hero?";
			next;
			mes "[Ansuriya]";
			mes "I don't like it. You're more comfortable doing it alone, calm down, Gerbena.";
			next;
			mes "[Gerbena]";
			mes "Ugh! Please take care of me!!";
			setquest 16537;
			close;
		case 0:
		case 1:
			mes "[Gerbena]";
			mes "Please hunt 15 <FONT COLOR = 0000CD>Mutation Chimera Napeo and Mutant Chimera Galensis</FONT> each.";
			mes "Both are creatures that imitate human form, but add a powerful transformation of the chimera properties to it.";
			close;
		case 2:
			mes "[Gerbena]";
			mes "Now the Illusion Forces are deployed and continue their mission.";
			mes "Thanks to the hero, it's easy to enter and subdue the Chimera.";
			next;
			mes "[Gerbena]";
			mes "Ugh, I also wanted to see the hero's wonderful battle in person...";
			mes "Someday, maybe I'll have a chance to see you?";
			next;
			mes "[Gerbena]";
			mes "If it's okay with you, why don't you come back tomorrow and work with us?";
			erasequest 16537;
			setquest 16536;
			getexp 37253672,0;	// TODO: jexp
			close;
		}
		end;
	case 2:
		switch( checkquest(16538,PLAYTIME) ) {
		case -1:
			break;
		case 0:
		case 1:
			mes "[Gerbena]";
			mes "Have you already been there today? If so, how about taking a break?";
			mes "If you overwork your body, you may not do well.";
			next;
			mes "[Gerbena]";
			mes "Come back after dawn and work with us!";
			close;
		case 2:
			erasequest 16538;
			break;
		}
		switch( checkquest(16539,HUNTING) ) {
		case -1:
			mes "[Gerbena]";
			mes "Among the homuncules in the intensive culture chamber, there are Mutant Chimera Lavaeter and Mutant Chimera Fulgor.";
			next;
			mes "[Gerbena]";
			mes "It looks similar to the existing Homunculus Dieter and Homunculus Bayeri, but they are very different.";
			mes "It is different from a homunculus in that it reproduces by judging by itself without an owner.";
			next;
			mes "[Gerbena]";
			mes "You can't rescue or do anything. All, every single one of them is to be killed.";
			next;
			mes "[Gerbena]";
			mes "So, hero, would you like to help us hunt 15 <FONT COLOR = 0000CD>mutated Chimera Lavaeter and Mutant Chimera Fulgor</FONT> each?";
			next;
			if (select( "Help hunting", "Do not hunt" ) == 2) {
				mes "[Gerbena]";
				mes "Ah, you changed your words!";
				mes "Gerbena vs. Heartbroken!";
				next;
				mes "[Gerbena]";
				mes "But it was our one-sided request.";
				mes "Even if you refuse, we can't help it...";
				close;
			}
			mes "[Gerbena]";
			mes "It's an honor to help!";
			mes "Can I participate with that hero?";
			next;
			mes "[Ansuriya]";
			mes "He said he didn't like it. You're more comfortable doing it alone, calm down, Gerbena.";
			next;
			mes "[Gerbena]";
			mes "Ugh! Please take care of me!!";
			setquest 16539;
			close;
		case 0:
		case 1:
			mes "[Gerbena]";
			mes "Hero, can you hunt 15 <FONT COLOR = 0000CD>mutated chimera Lavaeter and mutated chimera Fulgor</FONT> each?";
			mes "You can't rescue or do anything. All, every single one of them is to be killed.";
			close;
		case 2:
			mes "[Gerbena]";
			mes "Yes! Mission completed, confirmed. Now, Illusion troops are in!";
			mes "Thanks to you, you will be able to easily enter and subdue the Chimera.";
			next;
			mes "[Gerbena]";
			mes "Ugh, I also wanted to see the hero's beautiful battle in person...";
			mes "Someday, maybe I'll have a chance to see you?";
			next;
			mes "[Gerbena]";
			mes "If it's okay with you, why don't you come back tomorrow and work with us?";
			erasequest 16539;
			setquest 16538;
			getexp 37325968,0;	// TODO: jexp
			close;
		}
		end;
	case 3:
		mes "[Gerbena]";
		mes "Ah, you changed your words!";
		mes "Gerbena vs. Heartbroken!";
		next;
		mes "[Gerbena]";
		mes "But it was our one-sided request.";
		mes "Even if you refuse, we can't help it...";
		close;
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST2, QMARK_YELLOW, "checkquest(16537,HUNTING) == 2" );
	questinfo( QTYPE_QUEST2, QMARK_YELLOW, "checkquest(16539,HUNTING) == 2" );

	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "checkquest(16536,PLAYTIME) == 2" );
	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "checkquest(16538,PLAYTIME) == 2" );

	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "BaseLevel >= 230 && (checkquest(16537,HUNTING) == -1 && checkquest(16536,PLAYTIME) == -1)" );
	questinfo( QTYPE_DAILYQUEST, QMARK_YELLOW, "BaseLevel >= 230 && (checkquest(16539,HUNTING) == -1 && checkquest(16538,PLAYTIME) == -1)" );
	end;
}
